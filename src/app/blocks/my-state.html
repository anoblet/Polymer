<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/map-object/map-object.html">
<link rel="import" href="../../../bower_components/us-census/us-census.html">
<link rel="import" href="../../../bower_components/google-chart/google-chart.html">

<dom-module id="my-state">
    <template>
        <style>
            :host {
                width: 100%;
            }

            .full-width {
                width: 100%;
            }

            .text-right {
                text-align: right;
            }

            google-chart {
                width: 100%;
                height: auto;
                position: relative;
            }
        </style>
        <app-data data="{{data}}"></app-data>
        <!--
        <map-object source="{{data.location}}" target="{{location}}"></map-object>
        -->
        <map-object source="{{data.location.state}}" target="{{state}}"></map-object>
        <map-object source="{{data.location.state.name}}" target="{{name}}"></map-object>
        <map-object source="{{data.location.state.areaLandFormatted}}" target="{{areaLand}}"></map-object>
        <map-object source="{{data.location.state.areaWaterFormatted}}" target="{{waterFormatted}}"></map-object>
        <map-object source="{{data.location.state.population}}" target="{{population}}"></map-object>
        <div class="grid">
            <div class="grid-item"></div>
        </div>
        <table class="full-width">
            <tr>
                <td>Name</td>
                <td class="text-right">[[state.name]]</td>
            </tr>
            <tr>
                <td>Land Area</td>
                <td class="text-right">[[state.areaLandFormatted]]</td>
            </tr>
            <tr>
                <td>Water Area</td>
                <td class="text-right">[[state.areaWaterFormatted]]</td>
            </tr>
            <tr>
                <td>Population</td>
                <td class="text-right">[[state.populationFormatted]]</td>
            </tr>
        </table>
        <google-chart type='pie' options='{"title": "Terrain Makeup"}' data="[[chartData]]"></google-chart>
    </template>
    <script>
        class MyState extends Polymer.MutableData(Polymer.Element) {
            static get is() {
                return 'my-state';
            }

            static get properties() {
                return {}
            }

            static get observers() {
                return [
                    "_stateChanged(state.name)",
                    "_terrainRatio(state.areaLand, state.areaWater)"
                ]
            }

            _stateChanged(name) {
                let url = name.split(" ").join("-").toLowerCase();
                this.set("state.url", url);
            }

            _terrainRatio() {
                this.percentLand = ((this.state.areaLand / (this.state.areaLand + this.state.areaWater)) * 100).toFixed(0);
                this.percentWater = ((this.state.areaWater / (this.state.areaLand + this.state.areaWater)) * 100).toFixed(0);
                console.log(this.percentLand);
                console.log(this.percentWater);
                this.chartData = [["Terrain", "Percent"], ["Land", this.state.areaLand], ["Water", this.state.areaWater]];
                console.log(this.chartData);
            }
        }

        window.customElements.define(MyState.is, MyState);
    </script>
</dom-module>
