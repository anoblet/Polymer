<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/app-storage/app-localstorage/app-localstorage-document.html">
<link rel="import" href="../../bower_components/paper-swatch-picker/paper-swatch-picker.html">
<link rel="import" href="../../bower_components/my-singleton/my-singleton.html">
<link rel="import" href="HelperMixin.html">

<dom-module id="settings-styles">
    <template>
        <template is="dom-if" if="[[_isEqual(version, 1)]]">
            <div>
                Page background color:
                <paper-swatch-picker color="{{styles.pageBackgroundColor}}"></paper-swatch-picker>
            </div>
            <div>
                Card header background color:
                <paper-swatch-picker color="{{styles.cardHeaderBackgroundColor}}"></paper-swatch-picker>
            </div>
            <div>
                Card header text color:
                <paper-swatch-picker color="{{styles.cardHeaderTextColor}}"></paper-swatch-picker>
            </div>
            <div>
                Card content background color:
                <paper-swatch-picker color="{{styles.cardContentBackgroundColor}}"></paper-swatch-picker>
            </div>
            <div>
                Toolbar background color:
                <paper-swatch-picker color="{{styles.toolbarBackgroundColor}}"></paper-swatch-picker>
            </div>
        </template>
        <template is="dom-if" if="[[_isEqual(version, '2')]]">
            <div class="grid">
                <div>
                    <paper-input label="Primary color" value="{{styles.primaryColor}}"></paper-input>
                    <paper-swatch-picker color="{{styles.primaryColor}}"></paper-swatch-picker>
                    <paper-button on-click="randomPrimaryColor">Random!</paper-button>
                </div>
                <div>
                    <paper-input label="Secondary color" value="{{styles.secondaryColor}}"></paper-input>
                    <paper-swatch-picker color="{{styles.secondaryColor}}"></paper-swatch-picker>
                    <paper-button on-click="randomPrimaryColor">Random!</paper-button>
                </div>
            </div>
        </template>
        <my-singleton property="styles" value="{{styles}}"></my-singleton>
    </template>
    <script>
        class SettingsStyles extends HelperMixin(Polymer.Element) {
            static get is() {
                return 'settings-styles';
            }

            static get properties() {
                return {
                    styles: {
                        type: Object,
                        value: {}
                    },
                    version: {
                        type: String,
                        value: "1"
                    }
                }
            }

            static get observers() {
                return [
                    '_stylesChanged(styles.*)'
                ]
            }

            connectedCallback() {
                /*
                super.connectedCallback();
                let items = this.$$("paper-swatch-picker").defaultColors();
                var item = items[Math.floor(Math.random()*items.length)];
                // console.log(item);
                // this.styles.primaryColor = item;
                setTimeout(() => {
                    this.set("styles.primaryColor", item);
                }, 2000);
                // this.notifyPath("styles.primaryColor");
                */
            }

            _stylesChanged(change) {
                console.log(change);
                let styles = change.base;
                if(Object.keys(styles).length) {
                    this.dispatchEvent(new CustomEvent('stylesChangedEvent', {
                        bubbles: true,
                        composed: true,
                        detail: change
                    }));
                }
            }

            _camelToHyphen(str) {
                return str.replace(/([a-zA-Z])(?=[A-Z])/g, '$1-').toLowerCase();
            }

            _randomPrimaryColor() {
                let colors;
                this.set("styles.primaryColor", color);
            }
        }

        window.customElements.define(SettingsStyles.is, SettingsStyles);
    </script>
</dom-module>
